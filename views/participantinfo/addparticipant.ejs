<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add User</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/styles.css">
</head>

<body class="bg-light custom-bg">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg er-nav">
  <div class="container d-flex justify-content-between align-items-center">

    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center" href="/">
      <img src="/images/ella.jpeg" class="er-logo-small me-2">
      <span class="fw-bold">Ella Rises</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navMenu">
      <ul class="navbar-nav ms-auto align-items-center gap-2">

        <% if (!user) { %>
          <li class="nav-item">
            <a class="nav-link er-donate-btn" href="/login">Login</a>
          </li>
        <% } else { %>
          <li class="nav-item"><a class="nav-link nav-btn" href="/surveys">Surveys</a></li>
          <li class="nav-item"><a class="nav-link nav-btn" href="/milestones">Milestones</a></li>
          <li class="nav-item"><a class="nav-link nav-btn" href="/donations">Donations</a></li>
          <li class="nav-item"><a class="nav-link nav-btn" href="/events">Events</a></li>

          <% if (user.role === "admin") { %>
            <li class="nav-item"><a class="nav-link nav-btn" href="/participants">Participants</a></li>
            <li class="nav-item"><a class="nav-link nav-btn" href="/dashboard">Dashboard</a></li>
          <% } %>

          <li class="nav-item">
            <a class="nav-link nav-btn logout-btn" href="/logout">Logout</a>
          </li>
        <% } %>
      </ul>
    </div>

  </div>
</nav>

  <!-- Error Alert -->
  <% if (typeof error !== 'undefined' && error) { %>
  <div class="container mb-3">
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <%= error %>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  </div>
  <% } %>

  <!-- Form Card -->
  <div class="container">
    <div class="card shadow-sm">
      <div class="card-header bg-white border-bottom-0 pt-4">
        <h4 class="fw-semibold text-center">Participant Details</h4>
      </div>

      <div class="card-body">

        <form action="/addparticipant" method="POST" class="row g-3">

          <!-- Email -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">Email</label>
            <input type="email" class="form-control" name="email" required>
          </div>

          <!-- Password -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">Password</label>
            <input type="password" class="form-control" name="password" required>
          </div>

          <!-- First / Last Name -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">First Name</label>
            <input type="text" class="form-control" name="first_name" required>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Last Name</label>
            <input type="text" class="form-control" name="last_name" required>
          </div>

          <!-- DOB -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">Date of Birth</label>
            <input type="date" class="form-control" name="dob" required>
          </div>

          <!-- City / State / ZIP -->
          <div class="col-md-4">
            <label class="form-label fw-semibold">City</label>
            <input type="text" class="form-control" name="city" required>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">State</label>
            <input type="text" class="form-control" name="state" placeholder="UT" required>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">ZIP Code</label>
            <input type="text" class="form-control" name="zip" required>
          </div>

          <!-- School / Employer -->
          <div class="col-12">
            <label class="form-label fw-semibold">School or Employer</label>
            <input type="text" class="form-control" name="school_or_employer" required>
          </div>

          <!-- Phone -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">Phone</label>
            <input 
              type="text" 
              class="form-control"
              id="phone"
              name="phone"
              placeholder="801-342-2679"
              maxlength="12"
              pattern="^\d{3}-\d{3}-\d{4}$"
              required
            >
            <div class="form-text">Format: 801-000-0000</div>
          </div>

          <!-- Role -->
          <div class="col-md-6">
            <label class="form-label fw-semibold">Role</label>
            <div class="d-flex gap-4">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="role" id="roleAdmin" value="admin" required>
                <label class="form-check-label" for="roleAdmin">Admin</label>
              </div>

              <div class="form-check">
                <input class="form-check-input" type="radio" name="role" id="roleParticipant" value="participant" required>
                <label class="form-check-label" for="roleParticipant">Participant</label>
              </div>
            </div>
          </div>

          <!-- Field of Interest -->
          <div class="col-12">
            <label class="form-label fw-semibold">Field of Interest</label>
            <div class="d-flex gap-4">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="field_of_interest" id="interestSTEM" value="STEM" required>
                <label class="form-check-label" for="interestSTEM">STEM</label>
              </div>

              <div class="form-check">
                <input class="form-check-input" type="radio" name="field_of_interest" id="interestArts" value="Arts" required>
                <label class="form-check-label" for="interestArts">Arts</label>
              </div>

              <div class="form-check">
                <input class="form-check-input" type="radio" name="field_of_interest" id="interestBoth" value="Both" required>
                <label class="form-check-label" for="interestBoth">Both</label>
              </div>
            </div>
          </div>

          <!-- Buttons -->
          <div class="col-12 d-flex justify-content-between mt-4">
            <a href="/participants" class="btn btn-secondary px-4">Back</a>
            <button type="submit" class="btn btn-success px-4">Save</button>
          </div>

        </form>

      </div>
    </div>
  </div>

  <!-- Phone Auto-Formatting -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const phoneInput = document.getElementById("phone");

      phoneInput.addEventListener("input", (e) => {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length > 3 && value.length <= 6) {
          value = value.slice(0, 3) + "-" + value.slice(3);
        } else if (value.length > 6) {
          value = value.slice(0, 3) + "-" + value.slice(3, 6) + "-" + value.slice(6, 10);
        }
        e.target.value = value;
      });
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
